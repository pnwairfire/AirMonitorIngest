<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add clustering information to a dataframe — addClustering • AirMonitorIngest</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add clustering information to a dataframe — addClustering"><meta property="og:description" content="Clustering is used to assign individual measurements to
deployment locations.
A temporary monitor will be moved around from time to time, sometimes across the country
and sometimes across the street.  We need to assign unique identifiers to each
new &quot;deployment&quot; but not when the monitor is moved a short distance.
We use clustering to find an appropriate number of unique &quot;deployments&quot;.
The sensitivity of this algorithm can be adjused with the clusterDiameter argument.
Standard kmeans clustering does not work well when clusters can have widely
differing numbers of members. A much better result is acheived with
the Partitioning Around Medoids method available in cluster::pam().
The value of clusterRadius is compared with the output of
cluster::pam(...)$clusinfo[,'av_diss'] to determine the number of clusters."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AirMonitorIngest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/AirMonitorIngest.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Developer_Style_Guide.html">Developer Style Guide</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pnwairfire/AirMonitorIngest/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add clustering information to a dataframe</h1>
    <small class="dont-index">Source: <a href="https://github.com/pnwairfire/AirMonitorIngest/blob/HEAD/R/addClustering.R" class="external-link"><code>R/addClustering.R</code></a></small>
    <div class="hidden name"><code>addClustering.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Clustering is used to assign individual measurements to
deployment locations.</p>
<p>A <em>temporary</em> monitor will be moved around from time to time, sometimes across the country
and sometimes across the street.  We need to assign unique identifiers to each
new "deployment" but not when the monitor is moved a short distance.</p>
<p>We use clustering to find an appropriate number of unique "deployments".
The sensitivity of this algorithm can be adjused with the clusterDiameter argument.</p>
<p>Standard <code>kmeans</code> clustering does not work well when clusters can have widely
differing numbers of members. A much better result is acheived with
the Partitioning Around Medoids method available in <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">cluster::pam()</a></code>.</p>
<p>The value of <code>clusterRadius</code> is compared with the output of
<code>cluster::pam(...)$clusinfo[,'av_diss']</code> to determine the number of clusters.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addClustering</span><span class="op">(</span></span>
<span>  <span class="va">tbl</span>,</span>
<span>  clusterDiameter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  lonVar <span class="op">=</span> <span class="st">"longitude"</span>,</span>
<span>  latVar <span class="op">=</span> <span class="st">"latitude"</span>,</span>
<span>  maxClusters <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  flagAndKeep <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>tbl</dt>
<dd><p>Tibble with geolocation information (<em>e.g.</em> created by
<code>wrcc_qualityControl()</code> or <code>airsis_qualityControl</code>).</p></dd>


<dt>clusterDiameter</dt>
<dd><p>Diameter in meters used to determine the number of
clusters (see description).</p></dd>


<dt>lonVar</dt>
<dd><p>Name of longitude variable in the incoming tibble.</p></dd>


<dt>latVar</dt>
<dd><p>Name of the latitude variable in the incoming tibble.</p></dd>


<dt>maxClusters</dt>
<dd><p>Maximum number of clusters to try.</p></dd>


<dt>flagAndKeep</dt>
<dd><p>Logical specifying flagging, rather than removal, of bad
data during the QC process.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Input tibble with additional columns: <code>clusterLon, clusterLat</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p><a href="https://working-with-data.mazamascience.com/2021/07/15/when-k-means-clustering-fails/" class="external-link">When k-means clustering fails</a></p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jonathan Callahan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

